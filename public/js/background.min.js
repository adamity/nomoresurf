import{getBlocklist,getIsWhitelist}from"./controller.min.js";import{ExtPay}from"../assets/ExtPay/ExtPay.min.js";const extpay=ExtPay("nomoresurf");extpay.startBackground(),chrome.runtime.onInstalled.addListener((()=>{chrome.storage.sync.get(["blocklist"],(function(t){void 0===t.blocklist&&chrome.storage.sync.set({blocklist:[]})})),chrome.storage.sync.get(["isWhitelist"],(function(t){void 0===t.whitelist&&chrome.storage.sync.set({isWhitelist:!1})}))})),chrome.tabs.onUpdated.addListener((async(t,e,s)=>{const o=new URL(s.url),i=await getBlocklist(),r=await getIsWhitelist();"http:"!=o.protocol&&"https:"!=o.protocol||(i.includes(o.hostname)&&!r||!i.includes(o.hostname)&&r)&&chrome.tabs.update(t,{url:chrome.runtime.getURL(`redirect.html?url=${o.hostname}`)})}));