import{getBlocklist,getIsWhitelist,getActiveTab}from"./controller.min.js";const blockSiteBtn=document.getElementById("blockSiteBtn"),editBlocklistBtn=document.getElementById("editBlocklistBtn");let activeTab=null,targetURL=null,blocklist=[],isWhitelist=!1;async function init(){activeTab=await getActiveTab(),targetURL=new URL(activeTab.url),"http:"!=targetURL.protocol&&"https:"!=targetURL.protocol?(blockSiteBtn.innerText="This site cannot be blocked",blockSiteBtn.disabled=!0):(blocklist=await getBlocklist(),isWhitelist=await getIsWhitelist(),blocklist.includes(targetURL.hostname)&&!isWhitelist?(blockSiteBtn.innerText="This site is already blocked",blockSiteBtn.disabled=!0):(blockSiteBtn.innerHTML=`Block <span class="text-lowercase">${targetURL.hostname}</span>`,blockSiteBtn.addEventListener("click",(()=>{if(isWhitelist){let t=blocklist.indexOf(targetURL.hostname);blocklist.splice(t,1)}else blocklist.push(targetURL.hostname);chrome.storage.sync.set({blocklist:blocklist}),window.close()}))))}init(),editBlocklistBtn.addEventListener("click",(()=>{chrome.runtime.openOptionsPage?chrome.runtime.openOptionsPage():window.open(chrome.runtime.getURL("options.html"))}));